# raspi-traffic-light

ラズパイで信号機を実装し、オブジェクト指向の概念を学ぶための教材です。

## 講義の流れ

1. オブジェクト指向とは
    - オブジェクト指向についての説明です。
2. ラズパイのセットアップ
    - 教材のプログラムを動かすための手順の説明です。
3. 親クラスの信号機の実装
    - すべての信号機に共通する機能を実装します。
4. 子クラスの信号機の実装
    - 親クラスで作成した共通機能に、特定の信号機でのみ使用する機能を追加します。
5. 実習
    - 右矢印信号を実装しましょう。
6. ふりかえり

## 1. オブジェクト指向とは

オブジェクト指向とは、プログラミングの考え方のひとつです。
オブジェクト指向の重要なポイントは次の２点です。

1. あらゆるものを「属性」と「振る舞い」により表現する
2. 同じ種類のものを差分で管理する

順番に説明していきます。

### 「属性」と「振る舞い」

属性とは、あらゆるものが持つすべての特徴です。
たとえばスマホであれば、次のような属性を持っています。

- 色（黒い、白い、青い、、、）
- OS（Android、iOS、、、）
- 充電ケーブル（USB Type-C、Lightning、、、）

そして振る舞いとは、あらゆるものが行うすべての動作を指します。
スマホを例に挙げると、次のような振る舞いを持ちます。

- SNSを開く
- 動画を再生する
- インターネットに接続する

このように属性と振る舞いを組み合わせることで、
スマホに限らずすべてのものを表現する、という考え方がオブジェクト指向の基本です。

### 差分による表現

たとえば、Aさんの持つiPhoneの属性と機能を次のように表現します。

- AさんのiPhone
  - 属性
    - 色: 黒
    - OS: iOS
    - 充電ケーブル: Lightning
  - 振る舞い
    - SNSを開く
    - 動画を再生する
    - インターネットに接続する

一方で、Bさんの持つiPhoneの属性と機能を次のように表現します。

- BさんのiPhone
  - 属性
    - 色: 白
    - OS: iOS
    - 充電ケーブル: Lightning
  - 振る舞い
    - SNSを開く
    - 動画を再生する
    - インターネットに接続する

ご覧の通りAさんとBさんのiPhoneでは、色以外の違いがありません。
色だけ違って他は全部同じだと言えると、簡単に表現できそうです。
試しに次のようにiPhoneを表現してみましょう。

- iPhone
  - 属性
    - OS: iOS
    - 充電ケーブル: Lightning
  - 機能
    - SNSを開く
    - 動画を再生する
    - インターネットに接続する

そしてAさんとBさんのiPhoneは次のように表現します。

- AさんのiPhone
  - 属性
    - iPhoneの属性
    - 色: 黒
  - 振る舞い
    - iPhoneの振る舞い

- BさんのiPhone
  - 属性
    - iPhoneの属性
    - 色: 白
  - 振る舞い
    - iPhoneの振る舞い

いかがでしょうか。色以外のすべての属性と機能を、iPhoneとしてまとめることができました。
このように差分で表現することで、効率的にプログラミングすることができます。

## 2. ラズパイのセットアップ

次のようにセットアップしてください。

TODO: 配線の画像を貼る

## 3. 親クラスの信号機の実装

### 動作確認

まずは次のコマンドを実行してください。

```bash
sudo python src/base_traffic_light.py
```

ただしくセットアップできていれば、信号機が点滅します。

無事に点滅した場合には、プログラムの中身を見ていきましょう。

### 解説

実行したプログラムでは、青・黄・赤の３色の信号を点灯させる信号機を実装しています。

この信号機は次の属性と振る舞いを持っています。

- 属性
  - 青いライト: `blue_light`
  - 黄色いライト: `yellow_light`
  - 赤いライト: `red_light`
- 振る舞い
  - 初期化する機能: `__init__()`
  - ライトを点灯させる機能: `lit_light()`
  - 青→黄→赤の順に点灯するライトをコントロールする機能: `__call__()`
  - 終了時にライトを消灯する機能: `__del__()`

属性と振る舞いを確認したら、子クラスの信号機の実装の確認に移りましょう。

## 4. 子クラスの信号機の実装

### 動作確認

まずは次のコマンドを実行してください。

```bash
sudo python src/allow_traffic_light.py
```

ただしくセットアップできていれば、矢印信号つきの信号機が点滅します。

無事に点滅した場合には、プログラムの中身を見ていきましょう。

### 解説

実行したプログラムでは、青・黄・赤の３色の信号に加えて、
左・中央・右の矢印信号を点灯させる信号機を実装しています。

この信号機は次の属性と振る舞いを持っています。

- 属性
  - 青いライト: `blue_light`
  - 黄色いライト: `yellow_light`
  - 赤いライト: `red_light`
  - 左矢印ライト: `left_allow_light`
  - 中央矢印ライト: `center_allow_light`
  - 右矢印ライト: `right_allow_light`
- 振る舞い
  - 初期化する機能: `__init__()`
  - ライトを点灯させる機能: `lit_light()`
  - 複数のライトを同時に点灯させる機能: `lit_multi_lights()`
  - 左矢印・中央矢印→青→黄→右矢印→赤の順に点灯するライトをコントロールする機能: `__call__()`
  - 終了時にライトを消灯する機能: `__del__()`

このうち親クラスと共通しているものを省略すると、次のように表現できます。

- 属性
  - 親クラスで定義した属性 + 
  - 左矢印ライト: `left_allow_light`
  - 中央矢印ライト: `center_allow_light`
  - 右矢印ライト: `right_allow_light`
- 振る舞い
  - 親クラスで定義した振る舞い + 
  - 初期化する機能: `__init__()`
  - 複数のライトを同時に点灯させる機能: `lit_multi_lights()`
  - 左矢印・中央矢印→青→黄→右矢印→赤の順に点灯するライトをコントロールする機能: `__call__()`


親クラスと重複している属性や振る舞いは省略して、差分だけを実装しています。

このように基本の属性や振る舞いと派生したものを分離することで、
実装する際に不要なコードを省略でき、より安全で効率的なプログラミングができます。

## 5. ふりかえり
